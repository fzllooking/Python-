# Xpath
```PYTHON
xpath使用:
注意:提前安装xpath插件(在谷歌商店中下载xpath helper)
快捷方式:ctrl+shift+x
1.安装lxml库
  pip install  -i https://pypi.douban.com/simple lxml
2.导入lxml.etree
  from lxml import etree
3.etree.parse() 解析本地文件
  html tree = etree.parse('xx.html')
4.etree.HTML() 服务器响应文件
  html tree = etree.HTML(response.read().decode('utf-8')
5.html_tree.xpath(xpath路径)

```
## xpath基本语法：
当前有一个html文件：
```HTML
<!DOCTYPE html>
<html lang="en">
<head>
<!--utf-8后面要加/，代表结束-->
    <meta charset="UTF-8"/>
    <title>Title</title>
</head>
<body>
    <ul>
        <li id="l1" class="c1">北京</li>
        <li>上海</li>
        <li>深圳</li>
        <li>武汉</li>
    </ul>

    <ul>
        <li>南昌</li>
        <li>长沙</li>
        <li>中国</li>
    </ul>
</body>
</html>
```
* 1.路径查询
```PYTHON
//:查找所有子孙节点，不考虑层级关系
/:找直接子节点
* 例如：
```python
from lxml import etree

# xpath解析本地文件
tree = etree.parse('xpath.html')

# 查找ul下面的li
li_list = tree.xpath('//ul/li')

# 或者:li_list = tree.xpath('//body//li')

print(tree)
print(li_list)
print(len(li_list))

# <lxml.etree._ElementTree object at 0x000001BD3325FF40>
# [<Element li at 0x1bd33664600>, <Element li at 0x1bd33664640>, <Element li at 0x1bd33664680>, <Element li at 0x1bd336646c0>, <Element li at 0x1bd33664700>, <Element li at 0x1bd33664780>, <Element li at 0x1bd336647c0>]
7
```


* 2.谓词查询
 ```PYTHON
//div[@id]
//div[@id="maincontent"]

* 例如，查询带有id的城市
from lxml import etree
tree = etree.parse('xpath.html')
# text()获取标签内的内容
li_list = tree.xpath('//ul/li[@id]/text()')

print(li_list)
print(len(li_list))

# ['北京']
# 1

* 又例如,查询id=l1的城市
from lxml import etree
tree = etree.parse('xpath.html')
# text()获取标签内的内容
# 注意，单引号中，字符串要加双引号
li_list = tree.xpath('//ul/li[@id="l1"]/text()')

print(li_list)
# ['北京']
```
* 3.属性查询
```PYTHON
//@class

* 例如：查找id为l1的class属性值
li = tree.xpath('//ul/li[@id="l1"]/@class')

# ['c1']
```

* 4.模糊查询
```PYTHON
//div[contains(@id,"he")]
//div[starts-with(@id, "he")]

* 例如，id里包含l的li标签
li_list = tree.xpath('//ul/li[contains(@id,"l")]/text()')
```

* 5.内容查询
```PYTHON
//div/h1/text()
```
